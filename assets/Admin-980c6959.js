import{c as h,b as v,d as k,e as R,s as M,r as d,j as e,L as f,O as V,f as c,g as C,h as E,i as D}from"./index-d08e6746.js";import{T as A,e as b}from"./theme-provider-427f1ff7.js";import"./axios-a28b9c02.js";import{S as I}from"./sweetalert2.esm.all-509645c6.js";import{a as g}from"./axios-7a713374.js";const y=h("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),w=h("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),L=h("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),X=h("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),T=h("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),B=[{id:"region1",text:"I",municipalities:[]},{id:"region2",text:"II",municipalities:[]},{id:"region3",text:"III",municipalities:[]},{id:"region4a",text:"IV-A",municipalities:[]},{id:"region5",text:"V",municipalities:[]},{id:"CAR",text:"CAR",municipalities:[]},{id:"region4b",text:"IV-B",municipalities:[]},{id:"region7",text:"VII",municipalities:[]},{id:"region8",text:"VIII",municipalities:[]},{id:"region6",text:"VI",municipalities:[]},{id:"region9",text:"IX",municipalities:[]},{id:"region10",text:"X",municipalities:[]},{id:"region11",text:"XI",municipalities:[]},{id:"region12",text:"XII",municipalities:[]},{id:"BARMM1",text:"BARMM I",municipalities:[]},{id:"BARMM2",text:"BARMM II",municipalities:[]},{id:"region13",text:"XIII",municipalities:[]}],F=[["I","II","III","IV-A","V"],["CAR","NCR","VII","VIII"],["VI","IX","X","XI","XII"],["BARMM I","BARMM II","XIII"]],S=n=>{const a={totalnewPending:0,totalnewPaid:0,totalnewPaidViaEgov:0,totalrenewPending:0,totalrenewPaid:0,totalrenewPaidViaEgov:0,totalmalePending:0,totalmalePaid:0,totalfemalePending:0,totalfemalePaid:0};return n.results.forEach(i=>{i.monthlyResults.forEach(t=>{a.totalnewPending+=t.newPending,a.totalnewPaid+=t.newPaid,a.totalnewPaidViaEgov+=t.newPaidViaEgov,a.totalrenewPending+=t.renewPending,a.totalrenewPaid+=t.renewPaid,a.totalrenewPaidViaEgov+=t.renewPaidViaEgov,a.totalmalePending+=t.malePending,a.totalmalePaid+=t.malePaid,a.totalfemalePending+=t.femalePending,a.totalfemalePaid+=t.femalePaid})}),a};function K(){const n=v(),a=k(),i=R(M),[t,m]=d.useState(!1),x=d.useRef(null),r=d.useRef(null),[j,u]=d.useState(!1);function N(){a(c(!0)),g.get("https://elguv1backend.ibpls.com/api/bp/lgu-list/").then(l=>{const s=B.map(o=>{var p;return{id:o.id,text:o.text,municipalities:(p=l.data)==null?void 0:p[o.id]}});a(c(!1)),a(C(s))}).catch(l=>{console.error("Error fetching regions:",l),I.fire({icon:"error",title:"Error",text:"Failed to fetch regions. Please try again later."})})}function P(){a(c(!0)),u(!0),r.current&&r.current.abort();const l=new AbortController;r.current=l,g.post("https://elguv1backend.ibpls.com/api/bp/transaction-count/",{locationName:i.real,startDate:i.startDate,endDate:i.endDate},{signal:l.signal}).then(s=>{const o=S(s.data);a(E(o)),a(D(s.data)),a(c(!1)),u(!1),console.log("Total results:",o)}).catch(s=>{g.isCancel(s)||s.name==="CanceledError"?console.warn("Transaction request was canceled."):(console.error("Error fetching transaction data:",s),I.fire({icon:"error",title:"Error",text:"Failed to fetch transaction data. Please try again later."})),a(c(!1)),u(!1)})}return d.useEffect(()=>(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{i.locationName.length!==0&&i.startDate&&i.endDate&&P()},1400),()=>{x.current&&clearTimeout(x.current)}),[i.locationName,i.startDate,i.endDate]),d.useEffect(()=>{N()},[]),e.jsxs(A,{defaultTheme:"light",storageKey:"vite-ui-theme",children:[e.jsxs("div",{className:"flex h-screen",children:[e.jsxs("aside",{className:"md:hidden flex w-[300px] bg-card border-r border-border flex-col",children:[e.jsx("div",{className:"flex justify-center items-center mt-5 border-border",children:e.jsx("img",{src:b,className:"w-[140px]",alt:""})}),e.jsxs("nav",{className:"flex flex-col mt-10 gap-6 ml-10",children:[e.jsxs(f,{to:"/elgu/admin/dashboard",className:`flex items-center gap-2 ${n.pathname==="/elgu/admin/dashboard"?"text-primary":"text-secondary-foreground"}`,children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs(f,{to:"/elgu/admin/report",className:`flex items-center gap-2 ${n.pathname==="/elgu/admin/report"?"text-primary":"text-secondary-foreground"}`,children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{children:"Reports"})]})]})]}),t&&e.jsxs("div",{className:"fixed inset-0 z-40 md:flex hidden",children:[e.jsxs("div",{className:"w-[250px] bg-card border-r border-border flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mt-5 px-4",children:[e.jsx("img",{src:b,className:"w-[120px]",alt:""}),e.jsx("button",{className:"p-2",onClick:()=>m(!1),"aria-label":"Close sidebar",children:e.jsx(T,{className:"w-6 h-6"})})]}),e.jsxs("nav",{className:"flex flex-col mt-10 gap-6 ml-10",children:[e.jsxs(f,{to:"/elgu/admin/dashboard",className:`flex items-center gap-2 ${n.pathname==="/elgu/admin/dashboard"?"text-primary":"text-secondary-foreground"}`,onClick:()=>m(!1),children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs(f,{to:"/elgu/admin/report",className:`flex items-center gap-2 ${n.pathname==="/elgu/admin/report"?"text-primary":"text-secondary-foreground"}`,onClick:()=>m(!1),children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{children:"Reports"})]})]})]}),e.jsx("div",{className:"flex-1 bg-black bg-opacity-40",onClick:()=>m(!1)})]}),e.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[e.jsx("header",{className:"bg-card border-b h-[50px] border-border",children:e.jsxs("div",{className:"flex justify-between items-center h-full gap-4 mr-5 px-4",children:[e.jsx("button",{className:"hidden md:flex p-2",onClick:()=>m(!0),"aria-label":"Open sidebar",children:e.jsx(X,{className:"w-6 h-6"})}),e.jsx("div",{className:"flex-1 flex justify-end"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-background",children:e.jsx(V,{})})]})]}),j&&e.jsxs("button",{onClick:()=>{r.current&&(r.current.abort(),r.current=null),u(!1),a(c(!1))},className:"fixed bottom-4 text-xs right-4 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full shadow-lg z-50",children:["Cancel Request  ",e.jsx(L,{className:"inline w-4 h-4 animate-spin ml-2"})]})]})}export{K as default,F as regionGroups};
